var i=(t,e,n)=>new Promise((o,r)=>{var s=a=>{try{c(n.next(a))}catch(l){r(l)}},d=a=>{try{c(n.throw(a))}catch(l){r(l)}},c=a=>a.done?o(a.value):Promise.resolve(a.value).then(s,d);c((n=n.apply(t,e)).next())});const elements={previewContainer:document.getElementById("previewContainer"),previewOverlay:document.getElementById("previewOverlay"),jsonPreview:document.getElementById("jsonPreview"),downloadLink:document.getElementById("downloadLink")},BASE_URL="https://raw.githubusercontent.com/Purple-EyeZ/Bunny-Theme-Keys/refs/heads/main/src/Templates/";function fetchTemplate(t){return i(this,null,function*(){try{const e=yield fetch(`${BASE_URL}${t}`);if(!e.ok)throw new Error(`Failed to fetch template: ${e.status} - ${e.statusText}`);return e}catch(e){throw console.error("Network error:",e),new Error("Failed to fetch template. Please check your internet connection.")}})}function showPreview(t){return i(this,null,function*(){const{previewContainer:e,previewOverlay:n,jsonPreview:o,downloadLink:r}=elements;try{o.textContent="Loading...",document.body.classList.add("modal-open"),n.classList.add("visible"),e.classList.add("visible");const d=yield(yield fetchTemplate(t)).json();requestAnimationFrame(()=>{o.textContent=JSON.stringify(d,null,2)}),r.onclick=()=>downloadTemplate(t)}catch(s){console.error("Error loading preview:",s),o.textContent="Failed to load preview. Please try again."}})}function downloadTemplate(t){return i(this,null,function*(){try{const n=yield(yield fetchTemplate(t)).blob(),o=document.createElement("a");o.href=URL.createObjectURL(n),o.download=t;const r=document.querySelector(".temp-download-link");r&&document.body.removeChild(r),o.classList.add("temp-download-link"),o.style.display="none",document.body.appendChild(o),o.click(),setTimeout(()=>{document.body.removeChild(o),URL.revokeObjectURL(o.href)},100)}catch(e){console.error("Error downloading template:",e),alert("Failed to download template. Please try again later.")}})}function closePreview(){const{previewContainer:t,previewOverlay:e}=elements;document.body.classList.remove("modal-open"),t.classList.remove("visible"),e.classList.remove("visible"),setTimeout(()=>{document.getElementById("jsonPreview").textContent=""},300)}document.addEventListener("DOMContentLoaded",()=>{const{previewOverlay:t}=elements;t==null||t.addEventListener("click",e=>{e.target===t&&closePreview()})});
