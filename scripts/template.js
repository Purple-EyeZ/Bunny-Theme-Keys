const elements={previewContainer:document.getElementById("previewContainer"),previewOverlay:document.getElementById("previewOverlay"),jsonPreview:document.getElementById("jsonPreview"),downloadLink:document.getElementById("downloadLink")},BASE_URL="https://raw.githubusercontent.com/Purple-EyeZ/Bunny-Theme-Keys/refs/heads/main/Templates/";async function fetchTemplate(e){try{const t=await fetch(`${BASE_URL}${e}`);if(!t.ok)throw new Error(`Failed to fetch template: ${t.status} - ${t.statusText}`);return t}catch(e){throw new Error("Failed to fetch template. Please check your internet connection.")}}async function showPreview(e){const{previewContainer:t,previewOverlay:n,jsonPreview:o,downloadLink:a}=elements;try{o.textContent="Loading...",document.body.classList.add("modal-open"),n.classList.add("visible"),t.classList.add("visible");const i=await fetchTemplate(e),l=await i.json();requestAnimationFrame((()=>{o.textContent=JSON.stringify(l,null,2)})),a.onclick=()=>downloadTemplate(e)}catch(e){o.textContent="Failed to load preview. Please try again."}}async function downloadTemplate(e){try{const t=await fetchTemplate(e),n=await t.blob(),o=document.createElement("a");o.href=URL.createObjectURL(n),o.download=e;const a=document.querySelector(".temp-download-link");a&&document.body.removeChild(a),o.classList.add("temp-download-link"),o.style.display="none",document.body.appendChild(o),o.click(),setTimeout((()=>{document.body.removeChild(o),URL.revokeObjectURL(o.href)}),100)}catch(e){alert("Failed to download template. Please try again later.")}}function closePreview(){const{previewContainer:e,previewOverlay:t}=elements;document.body.classList.remove("modal-open"),e.classList.remove("visible"),t.classList.remove("visible"),setTimeout((()=>{document.getElementById("jsonPreview").textContent=""}),300)}document.addEventListener("DOMContentLoaded",(()=>{const{previewOverlay:e}=elements;e?.addEventListener("click",(t=>{t.target===e&&closePreview()}))}));